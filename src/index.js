 // #     88                      ,ad8888ba,                     88        88
 // #     88                     d8"'    `"8b                    88        88
 // #     88                    d8'                              88        88
 // #     88                    88                               88        88
 // #     88                    88                               88        88
 // #     88                    Y8,                              88        88
 // #     88                     Y8a.    .a8P                    Y8a.    .a8P
 // #     88                      `"Y8888Y"'                      `"Y8888Y"'
 // #
 // #
 // #
 // #
 // #     						               ...----....
 // #                         ..-:"''         ''"-..
 // #                      .-'                      '-.
 // #                    .'              .     .       '.
 // #                  .'   .          .    .      .    .''.
 // #                .'  .    .       .   .   .     .   . ..:.
 // #              .' .   . .  .       .   .   ..  .   . ....::.
 // #             ..   .   .      .  .    .     .  ..  . ....:IA.
 // #            .:  .   .    .    .  .  .    .. .  .. .. ....:IA.
 // #           .: .   .   ..   .    .     . . .. . ... ....:.:VHA.
 // #           '..  .  .. .   .       .  . .. . .. . .....:.::IHHB.
 // #          .:. .  . .  . .   .  .  . . . ...:.:... .......:HIHMM.
 // #         .:.... .   . ."::"'.. .   .  . .:.:.:II;,. .. ..:IHIMMA
 // #         ':.:..  ..::IHHHHHI::. . .  ...:.::::.,,,. . ....VIMMHM
 // #        .:::I. .AHHHHHHHHHHAI::. .:...,:IIHHHHHHMMMHHL:. . VMMMM
 // #       .:.:V.:IVHHHHHHHMHMHHH::..:" .:HIHHHHHHHHHHHHHMHHA. .VMMM.
 // #       :..V.:IVHHHHHMMHHHHHHHB... . .:VPHHMHHHMMHHHHHHHHHAI.:VMMI
 // #       ::V..:VIHHHHHHMMMHHHHHH. .   .I":IIMHHMMHHHHHHHHHHHAPI:WMM
 // #       ::". .:.HHHHHHHHMMHHHHHI.  . .:..I:MHMMHHHHHHHHHMHV:':H:WM
 // #       :: . :.::IIHHHHHHMMHHHHV  .ABA.:.:IMHMHMMMHMHHHHV:'. .IHWW
 // #       '.  ..:..:.:IHHHHHMMHV" .AVMHMA.:.'VHMMMMHHHHHV:' .  :IHWV
 // #        :.  .:...:".:.:TPP"   .AVMMHMMA.:. "VMMHHHP.:... .. :IVAI
 // #       .:.   '... .:"'   .   ..HMMMHMMMA::. ."VHHI:::....  .:IHW'
 // #       ...  .  . ..:IIPPIH: ..HMMMI.MMMV:I:.  .:ILLH:.. ...:I:IM
 // #     : .   .'"' .:.V". .. .  :HMMM:IMMMI::I. ..:HHIIPPHI::'.P:HM.
 // #     :.  .  .  .. ..:.. .    :AMMM IMMMM..:...:IV":T::I::.".:IHIMA
 // #     'V:.. .. . .. .  .  .   'VMMV..VMMV :....:V:.:..:....::IHHHMH
 // #       "IHH:.II:.. .:. .  . . . " :HB"" . . ..PI:.::.:::..:IHHMMV"
 // #        :IP""HHII:.  .  .    . . .'V:. . . ..:IH:.:.::IHIHHMMMMM"
 // #        :V:. VIMA:I..  .     .  . .. . .  .:.I:I:..:IHHHHMMHHMMM
 // #        :"VI:.VWMA::. .:      .   .. .:. ..:.I::.:IVHHHMMMHMMMMI
 // #        :."VIIHHMMA:.  .   .   .:  .:.. . .:.II:I:AMMMMMMHMMMMMI
 // #        :..VIHIHMMMI...::.,:.,:!"I:!"I!"I!"V:AI:VAMMMMMMHMMMMMM'
 // #        ':.:HIHIMHHA:"!!"I.:AXXXVVXXXXXXXA:."HPHIMMMMHHMHMMMMMV
 // #          V:H:I:MA:W'I :AXXXIXII:IIIISSSSSSXXA.I.VMMMHMHMMMMMM
 // #            'I::IVA ASSSSXSSSSBBSBMBSSSSSSBBMMMBS.VVMMHIMM'"'
 // #             I:: VPAIMSSSSSSSSSBSSSMMBSSSBBMMMMXXI:MMHIMMI
 // #            .I::. "H:XIIXBBMMMMMMMMMMMMMMMMMBXIXXMMPHIIMM'
 // #            :::I.  ':XSSXXIIIIXSSBMBSSXXXIIIXXSMMAMI:.IMM
 // #            :::I:.  .VSSSSSISISISSSBII:ISSSSBMMB:MI:..:MM
 // #            ::.I:.  ':"SSSSSSSISISSXIIXSSSSBMMB:AHI:..MMM.
 // #            ::.I:. . ..:"BBSSSSSSSSSSSSBBBMMMB:AHHI::.HMMI
 // #            :..::.  . ..::":BBBBBSSBBBMMMB:MMMMHHII::IHHMI
 // #            ':.I:... ....:IHHHHHMMMMMMMMMMMMMMMHHIIIIHMMV"
 // #              "V:. ..:...:.IHHHMMMMMMMMMMMMMMMMHHHMHHMHP'
 // #               ':. .:::.:.::III::IHHHHMMMMMHMHMMHHHHM"
 // #                 "::....::.:::..:..::IIIIIHHHHMMMHHMV"
 // #                   "::.::.. .. .  ...:::IIHHMMMMHMV"
 // #                     "V::... . .I::IHHMMV"'
 // #                       '"VHVHHHAHHHHMMV:"'



//                        |      _______ _______ _______
//                        |      |______    |    |______
//                        |_____ |______    |    ______|
//
//
//                              ______ _______ _______
//                             |  ____ |______    |
//                             |_____| |______    |
//
//
//                                _____ _______
//                                  |      |
//                                __|__    |




document.addEventListener('DOMContentLoaded', () => {
  console.log(
        "%c Easy Day",
        "font-weight: bold; font-size: 50px;color: red; text-shadow: 3px 3px 0 rgb(217,31,38) , 6px 6px 0 rgb(226,91,14) , 9px 9px 0 rgb(245,221,8) , 12px 12px 0 rgb(5,148,68) , 15px 15px 0 rgb(2,135,206) , 18px 18px 0 rgb(4,77,145) , 21px 21px 0 rgb(42,21,113)"
      );

  const POKEURL  = "http://localhost:3000/pokemon"
  const topPage = document.querySelector("#container")
  const pokeCon = document.querySelector("#pokemon-container")
  var pokeArr = []
  getPoke()
  addPokeButton()



  function addPokeButton(){
    topPage.children[3].innerHTML =`
      <center><button  id="add"  >Add a Pokemon</button></center>
      `
  }

  function renderAllpokemon(pokeArr){
    pokeCon.innerHTML = pokeArr.map(poke =>{
    return makeDatPoke(poke)
  }).join("")
 }

function getPoke(){
fetch(POKEURL)
  .then(r=>r.json())
  .then(pokemons =>{
    pokeArr = pokemons
    renderAllpokemon(pokeArr)
    topPage.querySelector('center').innerHTML =  `There are ${pokeArr.length} Pokemon  here`
    })
  }


function makeDatPoke(poke){
  return  `
  <div class="pokemon-card">
      <div class="pokemon-frame">
        <h1 class="center-text">${poke.name}</h1>
        <div class="pokemon-image">
          <img data-id="${poke.id}" data-action="flip" id="pic" class="toggle-sprite" src=${poke.sprites.front}>
          <button id="edit" >edit</button>   <button id="del" >delete</button>
        </div>
      </div>
    </div>
  `
}


document.querySelector("body").addEventListener("click", e=> {
  e.preventDefault()
  switch(e.target.id){
    case "add":
    renderCreateform(e)
    break
    case "create-submit":
    addPoke(e)
    break
    case "edit":
    renderEditform(e)
    break
    case "edit-submit":
    editPokemon(e)
    break
    case "del":
    delPokemon(e)
    break
    case
    "pic":
    flip(e)
    break
  }

})

function renderCreateform(e){
    topPage.children[3].innerHTML = `
    <center>
      <form class="edit-pokemon-form" style="">
     <h3>Add A Pokemon!</h3>
     <input type="text" name="name" value="" placeholder="Enter Pokemon's name..." class="input-text">
     <br>
     <input type="text" name="image" value="" placeholder="Enter Pokemon's front URL..." class="input-text">
     <br>
     <input type="text" name="image" value="" placeholder="Enter Pokemon's back URL..." class="input-text">
     <br>
     <input type="submit" id="create-submit" name="submit" value="Create a Pokemon">
   </form>
   </center>
  `
}


function addPoke(e){

  let name = e.target.parentElement.children[1].value
  let front = e.target.parentElement.children[3].value
  let back = e.target.parentElement.children[5].value

  if (name === "" || front === "" || back === "") {
  alert("You can't leave Dat Pokemon Info blank")
  }
   else {
   fetch(POKEURL, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Accept": "application/json"
        },
        body: JSON.stringify({
                    name,
                    sprites: {
                      front,
                      back
                    }

        })
      })
      .then(r=>r.json())
      .then(newPoke=>{
      pokeCon.innerHTML += (makeDatPoke(newPoke))
      addPokeButton()
      })
    }
}


function renderEditform(e){
  if (e.target.innerHTML.length <= 4){
    e.target.innerHTML += `
      <form class="edit-pokemon-form" style="">
       <h3>Edit this Pokemon!</h3>

       <input type="text" name="name" value="" placeholder="Enter new Pokemon's name..." class="input-text">
       <br>
       <input type="text" name="image" value="" placeholder="Enter new Pokemon's front URL..." class="input-text">
       <br>
       <input type="text" name="image" value="" placeholder="Enter new Pokemon's back URL..." class="input-text">
       <br>
       <input type="submit" id="edit-submit" name="submit" value="Edit This Pokemon">
     </form>
    `
  }

}

//
function editPokemon(e){
  let pokeId = parseInt(e.target.parentElement.parentElement.parentElement.firstElementChild.dataset.id)

  name = e.target.parentElement.children[1].value
  front = e.target.parentElement.children[3].value
  back = e.target.parentElement.children[5].value

  if (name === "" || front === "" || back === "") {
  alert("You can't leave Dat Pokemon Info blank")
 }
  else{

  fetch(`http://localhost:3000/pokemon/${pokeId}`,{
      method: "PATCH",
      headers: {
        "Content-Type": "application/json",
        "Accept": "application/json"
      },
      body: JSON.stringify({
        name,
        sprites:{
          front,
          back
        }
      })
    }).then(r=>r.json())
      .then(editedPoke=>{
        let foundPoke = pokeArr.find(poke=>{
        return poke.id === editedPoke.id})
        pokeArr[pokeArr.indexOf(foundPoke)] = editedPoke
        renderAllpokemon(pokeArr)
      })
    }
  }

     // ****this is that basic way////
                  // foundPoke.name = name
                  // foundPoke.sprites.front = front
                  // foundPoke.sprites.back = back
                  // e.target.parentElement.parentElement.parentElement.parentElement.children[0].innerText = name
                  // e.target.parentElement.parentElement.parentElement.children[0].src = front
                  //




function delPokemon(e){

  let pokeId = parseInt(e.target.parentElement.parentElement.children[1].children[0].dataset.id)


  fetch(`http://localhost:3000/pokemon/${pokeId}`,{
    method: "DELETE"
  })
  let foundPoke = pokeArr.find(poke=>{
  return poke.id === pokeId})
  pokeArr.splice([pokeArr.indexOf(foundPoke)], 1)
  pokeCon.innerHTML = pokeArr.map(poke=>{
  return makeDatPoke(poke)
  }).join("")
  }



  document.querySelector("body").addEventListener("input", e=>{
      if (e.target.id === "pokemon-search-input"){
          let input = e.target.value
          let filterPokes = pokeArr.filter(poke=>{
          return poke.name.includes(input)
        })
          pokeCount(filterPokes)
          pokeCon.innerHTML = filterPokes.map(poke=>{
           return makeDatPoke(poke)
        }).join("")
      }
      pokeCount()
  })



  function flip(e){
    if (!!event.target.dataset.id) {
          let pokemon = pokeArr.find(poke => poke.id == e.target.dataset.id)
          if (e.target.src === pokemon.sprites.front)
           {
            e.target.src = pokemon.sprites.back
          }
          else {
            e.target.src = pokemon.sprites.front
          }
      }
  }

  function pokeCount(filterPokes){
    if (filterPokes)
    topPage.querySelector('center').innerHTML =  `There are ${filterPokes.length} Pokemon  here`
  }




})
